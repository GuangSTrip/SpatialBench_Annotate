<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·¯å¾„è°ƒè¯•æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-info { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .video-container { margin: 20px 0; border: 1px solid #ccc; padding: 20px; }
        video { width: 100%; max-width: 600px; height: auto; }
    </style>
</head>
<body>
    <h1>ğŸ” YouTubeè§†é¢‘è·¯å¾„è°ƒè¯•æµ‹è¯•</h1>
    
    <div class="debug-info">
        <h3>æµ‹è¯•è·¯å¾„æ„é€ </h3>
        <p>å½“å‰æµ‹è¯•è·¯å¾„: <code id="testPath"></code></p>
        <button onclick="testPath()">æµ‹è¯•è·¯å¾„</button>
        <div id="pathResult"></div>
    </div>
    
    <div class="video-container">
        <h3>è§†é¢‘æ’­æ”¾æµ‹è¯•</h3>
        <video id="testVideo" controls preload="metadata">
            <source id="videoSource" src="" type="video/mp4">
            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
        </video>
        <div id="videoStatus"></div>
    </div>
    
    <script>
        // æ¨¡æ‹Ÿä¸»åº”ç”¨çš„è·¯å¾„æ„é€ é€»è¾‘
        function constructYouTubePath(datasetId, sampleId) {
            return `/static/videos/${datasetId}/${sampleId}/${sampleId}_youtube.mp4`;
        }
        
        // æµ‹è¯•ä¸åŒçš„è·¯å¾„ç»„åˆ
        function testPath() {
            const testCases = [
                { datasetId: 'test_dataset', sampleId: 'test_youtube' },
                { datasetId: 'unknown', sampleId: 'test_youtube' },
                { datasetId: 'test_dataset', sampleId: 'unknown' }
            ];
            
            const resultDiv = document.getElementById('pathResult');
            resultDiv.innerHTML = '<h4>è·¯å¾„æµ‹è¯•ç»“æœ:</h4>';
            
            testCases.forEach((testCase, index) => {
                const path = constructYouTubePath(testCase.datasetId, testCase.sampleId);
                const status = testCase.datasetId === 'test_dataset' && testCase.sampleId === 'test_youtube' ? 'âœ… æ­£ç¡®' : 'âŒ é”™è¯¯';
                
                resultDiv.innerHTML += `
                    <div style="margin: 10px 0; padding: 10px; background: ${status.includes('âœ…') ? '#d4edda' : '#f8d7da'}; border-radius: 4px;">
                        <strong>æµ‹è¯• ${index + 1}:</strong> ${status}<br>
                        <code>datasetId: "${testCase.datasetId}", sampleId: "${testCase.sampleId}"</code><br>
                        <code>æ„é€ è·¯å¾„: "${path}"</code>
                    </div>
                `;
            });
            
            // ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„æµ‹è¯•è§†é¢‘æ’­æ”¾
            const correctPath = constructYouTubePath('test_dataset', 'test_youtube');
            document.getElementById('testPath').textContent = correctPath;
            
            const video = document.getElementById('testVideo');
            const source = document.getElementById('videoSource');
            source.src = correctPath;
            video.load();
            
            // ç›‘å¬è§†é¢‘äº‹ä»¶
            video.addEventListener('loadstart', () => {
                document.getElementById('videoStatus').innerHTML = '<div style="color: blue;">ğŸ”„ è§†é¢‘å¼€å§‹åŠ è½½</div>';
            });
            
            video.addEventListener('loadedmetadata', () => {
                document.getElementById('videoStatus').innerHTML = '<div style="color: green;">ğŸ“Š è§†é¢‘å…ƒæ•°æ®å·²åŠ è½½</div>';
            });
            
            video.addEventListener('canplay', () => {
                document.getElementById('videoStatus').innerHTML = '<div style="color: green;">âœ… è§†é¢‘å¯ä»¥æ’­æ”¾</div>';
            });
            
            video.addEventListener('error', (e) => {
                const error = video.error;
                let errorMessage = 'æœªçŸ¥é”™è¯¯';
                if (error) {
                    switch(error.code) {
                        case 1: errorMessage = 'è§†é¢‘åŠ è½½è¢«ä¸­æ–­'; break;
                        case 2: errorMessage = 'ç½‘ç»œé”™è¯¯'; break;
                        case 3: errorMessage = 'è§†é¢‘è§£ç å¤±è´¥'; break;
                        case 4: errorMessage = 'è§†é¢‘æ ¼å¼ä¸æ”¯æŒ'; break;
                    }
                }
                document.getElementById('videoStatus').innerHTML = `<div style="color: red;">âŒ ${errorMessage} (ä»£ç : ${error?.code || 'N/A'})</div>`;
            });
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
        window.addEventListener('load', testPath);
    </script>
</body>
</html>
